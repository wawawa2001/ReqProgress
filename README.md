# Flask アプリケーションの README

## 概要
このプロジェクトは、Flask を使用して構築されたウェブアプリケーションです。アプリケーションは PostgreSQL データベースに接続し、いくつかの主要な機能を提供します。

## 主な機能
1. **リクエストの管理と表示**
   - `/req` エンドポイントで特定のリクエスト情報を取得し表示します。
   - `/manage` エンドポイントで特定の管理者に関連するリクエストを一覧表示します。

2. **リクエストの編集と削除**
   - `/reqedit` エンドポイントでリクエストの作成、編集を行います。
   - `/delete` エンドポイントでリクエストを削除します。

3. **ロギング**
   - アプリケーションの動作状況を詳細に記録するロギング機能を備えています。
   - ログはファイルとコンソールに出力されます。

## ファイル構成
- `app.py` : メインの Flask アプリケーション。
- `templates/` : HTML テンプレートを格納するディレクトリ。
- `app.log` : アプリケーションのログファイル。

## 必要要件
- Python 3.x
- Flask
- Flask-SQLAlchemy
- PostgreSQL データベース

## セットアップ手順
1. **依存関係のインストール**
    ```bash
    pip install flask flask-sqlalchemy
    ```

2. **データベースの設定**
   - PostgreSQL データベースを作成し、`app.config['SQLALCHEMY_DATABASE_URI']` の値を適切に設定します。

3. **アプリケーションの起動**
    ```bash
    python app.py
    ```

4. **アクセス**
   - ブラウザで `http://0.0.0.0:8001` にアクセスします。

## エンドポイントの詳細
### `/`
- **概要**: トップページを表示します。
- **HTTP メソッド**: GET

### `/delete`
- **概要**: 指定された `mgr_id` と `req_id` に基づいてリクエストを削除します。
- **HTTP メソッド**: GET
- **パラメータ**:
  - `id` : 管理者 ID
  - `req_id` : リクエスト ID

### `/req`
- **概要**: リクエストの詳細を表示します。
- **HTTP メソッド**: GET
- **パラメータ**:
  - `req_id` : リクエスト ID

### `/manage`
- **概要**: 指定された管理者 ID に関連するリクエストを一覧表示します。
- **HTTP メソッド**: GET
- **パラメータ**:
  - `id` : 管理者 ID

### `/reqedit`
- **概要**: リクエストを編集または新規作成します。
- **HTTP メソッド**: GET, POST
- **パラメータ**:
  - `id` : 管理者 ID
  - `req_id` : リクエスト ID

## ロギングについて
- ログは `app.log` ファイルに記録され、アプリケーションのデバッグや監視に利用できます。
- **ログレベル**: DEBUG, INFO, WARNING, ERROR

## 注意事項
- SSL 証明書 (`cert.pem` と `privkey.pem`) を適切に設定する必要があります。
- UUID の形式チェックを行う `is_valid_uuid` 関数を利用しています。

## トラブルシューティング
- **データベース接続エラー**:
  - データベースの URI が正しいか確認してください。
- **500 エラー**:
  - ログ (`app.log`) を確認してエラーの詳細を特定してください。

## ライセンス
このプロジェクトは MIT ライセンスの下で公開されています。
